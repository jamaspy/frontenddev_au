---
title: "Generate Route with fs and markdown"
date: "2022-09-19"
exerpt: "Setting up dynamic routes using fs and markdown"
description: "Using fileSystem to generate dynamic routes, getStaicProps, and getStaticPaths"
tags:
  - nextJS
  - getStaicProps
  - getStaticPaths
  - routes
  - markdown
---

## TLDR;

1. Pages are dynamically generated by mapping through the filesystem of the contents directory. Children files with in are used to generate the second part of the route. gray-matter and react-markdown are used to parse the yaml with in the \*.md files and render the styled markdown on the pages.
2. To add more pages add a new \*.md file to the required Area of Focus ensuring that the correct metadata is added to the top of the file.

## packages

- nodeJs fileSystem
- grey-matter
- react-markdown

nodes fs allows us to use the structure of the contents folder to generate our staticPaths and staticProps. The initial dynamic route for used for the “Area of Focus” is acquired by mapping through the parent folder and getting the names of the child directories i.e. assessments, carer, communication etc. The second part of the route is acquired by mapping through the child directories and getting the names of the child files i.e. assessment.md, carer.md, communication.md etc. The names of the files are used to generate the second part of the route. The names of the files are also used to generate the staticProps for the pages.

```js
export async function getStaticPaths() {
  const paths = fs
    .readdirSync(`${process.cwd()}/contents`)
    .map((area) => {
      const files = fs.readdirSync(`${process.cwd()}/contents/${area}`);
      return files.map((file) => ({
        params: {
          area: area,
          page: file.replace(".md", ""),
        },
      }));
    })
    .flat();
  return {
    paths,
    fallback: false,
  };
}
```

The staticProps are generated by reading the file using fs and parsing the yaml with grey-matter. The markdown is then rendered using react-markdown.

```js
export async function getStaticProps({ params }) {
  const { area, page } = params;
  const markdownWithMeta = fs.readFileSync(
    `${process.cwd()}/contents/${area}/${page}.md`,
    "utf-8"
  );
  const { data: frontmatter, content } = matter(markdownWithMeta);
  return {
    props: {
      frontmatter,
      content,
    },
  };
}
```

## Example \*.md file

```js
---
title: "Title Of Article"
date: "2022-09-19"
exerpt: "Short bit"
description: "Longer short bit"
tags:
  - Tag 1
  - Tag 2
---

# Assessment
Quis culpa duis dolor aliquip ullamco velit ipsum exercitation ea. Sunt ex aliqua non nostrud consequat consequat deserunt irure sint labore est quis. Qui duis qui id et aliqua do commodo deserunt do.

Veniam ad anim tempor ex occaecat velit duis pariatur cillum. Amet ut sit non consectetur aute minim voluptate eiusmod. Ex adipisicing ipsum velit irure. In exercitation non fugiat nisi minim commodo veniam eu. Dolor veniam duis non Lorem Lorem Lorem.
## Assessment

### Assessment
```
